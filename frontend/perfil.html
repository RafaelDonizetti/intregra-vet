<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/css/header.css" />
    <link rel="stylesheet" href="assets/css/perfil.css" />
    <link
      rel="shortcut icon"
      href="assets/img/Logo-integravet.png"
      type="image/x-icon"
    />
    <script src="./assets/js/cliente.js"></script>
    <script src="./assets/js/profilemodal.js"></script>
      
    <title>Perfil | IntegraVet</title>
  </head>
  <body>
    <header class="cabecalho">
      <nav class="cabecalho_nav">
        <picture class="cabecalho_logo">
          <img
            src="assets/img/Logo-integravet.png"
            alt="Logotipo da marca IntegraVet"
          />
        </picture>
        <div class="cabecalho_lista">
          <a href="/">Início</a>

          <a href="/quemsomos">Quem somos</a>

          <a href="#rodape">Contato</a>

          <a href="/projetos">Projetos</a>

          <a href="/login" id="loginBtn">LOGIN</a>

          <div id="profileBtn" style="display: none">
            <button id="userBtn">Nome do Usuário</button>
            <div id="profileDropdown" style="display: none">
              <!-- Conteúdo do dropdown aqui -->
              <a href="/perfil">Perfil</a>
              <a href="#">Configurações</a>
              <a href="#" id="logoutBtnInDropdown">Logout</a>
            </div>
          </div>
        </div>
        <!-- side bar -->
        <div id="mySidebar" class="sidebar">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"
            >×</a
          >
          <a href="/">Início</a>
          <a href="/quemsomos">Quem somos</a>
          <a href="#rodape">Contato</a>
          <a href="/projetos">Projetos</a>
          <a href="/login" id="loginBtn-sideBar">LOGIN</a>
          <a href="#" id="logoutBtn">LOGOUT</a>
        </div>
        <div id="main">
          <button class="openbtn" onclick="openNav()">☰</button>
        </div>
      </nav>
    </header>

    <main>
      <section class="profile-card">
        <div class="card">
          <div class="card-infos">
            <div class="header-card">
              <h1>Perfil do Usuário</h1>
              <span class="detalhe"></span>
              <img src="" id="profileImage" alt="Foto de perfil" />
            </div>
            <div class="pessoal-infos_input">
              <div class="pessoal-infos">
                <p><strong>Nome:</strong> <span id="profileUserName"></span></p>
                <p><strong>Email:</strong> <span id="profileEmail"></span></p>
              </div>
              <!--
                <div class="input">
                <input type="file" id="fileInput" accept="image/*">
                <button id="uploadButton">Inserir Foto</button>
              </div>
              !-->
            </div>
          </div>
          
          <button class="delete" id="btnDelete">EXCLUIR CONTA</button>
            <div id="deleteModal" class="modal">
              <p>Tem certeza de que deseja excluir?</p>
              <button id="confirmDelete" class="modal-btn">Sim</button>
              <button id="cancelDelete" class="modal-btn" onclick="closeModal()">Cancelar</button>
            </div>
            <div id="modalOverlay" class="overlay"></div>
        </div>
      </section>
    </main>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      function deleteCookie(cookieName) {
        document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
      }
      document.addEventListener("DOMContentLoaded", function () {
        const btnDelete = document.getElementById("confirmDelete")
        const email = document.getElementById("profileEmail")
         user = email.innerText
         const socket = io.connect("http://localhost:3000");

         btnDelete.addEventListener("click", function(){ 
          socket.emit("deleteUser", user);
          deleteCookie("authToken")
          setTimeout(function() {
            window.location.href = "/";
          }, 500); // Atraso de 1 segundo 
        })
     })
    </script>
  </body>
</html>
